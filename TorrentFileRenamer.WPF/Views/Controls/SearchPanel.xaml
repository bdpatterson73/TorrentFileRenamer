<UserControl x:Class="TorrentFileRenamer.WPF.Views.Controls.SearchPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:viewmodels="clr-namespace:TorrentFileRenamer.WPF.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=viewmodels:SearchViewModel}"
             d:DesignHeight="60" d:DesignWidth="800">

    <Border Background="{StaticResource SurfaceBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="0,0,0,1"
            Padding="16,12">

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" /> <!-- Search Icon -->
                <ColumnDefinition Width="*" /><!-- Search TextBox -->
                <ColumnDefinition Width="Auto" /> <!-- Clear Button -->
                <ColumnDefinition Width="Auto" /> <!-- Result Count -->
            </Grid.ColumnDefinitions>

            <!-- Search Icon -->
            <TextBlock Grid.Column="0"
                       Text="&#xE721;"
                       FontSize="20"
                       FontFamily="Segoe MDL2 Assets"
                       VerticalAlignment="Center"
                       Margin="0,0,12,0"
                       Foreground="{StaticResource TextSecondaryBrush}" />

            <!-- Search TextBox -->
            <TextBox Grid.Column="1"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource ModernTextBox}"
                     FontSize="14"
                     Padding="12,8"
                     VerticalAlignment="Center">
                <TextBox.InputBindings>
                    <KeyBinding Key="Enter" Command="{Binding SearchCommand}" />
                    <KeyBinding Key="Escape" Command="{Binding ClearSearchCommand}" />
                </TextBox.InputBindings>
                <TextBox.Resources>
                    <Style TargetType="TextBox" BasedOn="{StaticResource ModernTextBox}">
                        <Style.Triggers>
                            <Trigger Property="Text" Value="">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <VisualBrush Stretch="None" AlignmentX="Left">
                                            <VisualBrush.Visual>
                                                <TextBlock Text="Search files by name, movie/show, year..."
                                                           FontStyle="Italic"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           Margin="12,0,0,0" />
                                            </VisualBrush.Visual>
                                        </VisualBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </TextBox.Resources>
            </TextBox>

            <!-- Clear Button -->
            <Button Grid.Column="2"
                    Content="&#xE711;"
                    Command="{Binding ClearSearchCommand}"
                    Style="{StaticResource SecondaryButton}"
                    Padding="12,8"
                    Margin="8,0"
                    FontSize="16"
                    FontFamily="Segoe MDL2 Assets"
                    ToolTip="Clear search (Esc)"
                    Visibility="{Binding SearchText, Converter={StaticResource StringToVisibilityConverter}}" />

            <!-- Result Count -->
            <Border Grid.Column="3"
                    Background="{StaticResource PrimaryBrush}"
                    CornerRadius="12"
                    Padding="12,6"
                    Visibility="{Binding HasResults, Converter={StaticResource BoolToVisibilityConverter}}">
                <TextBlock Text="{Binding ResultSummary}"
                           Foreground="White"
                           FontSize="12"
                           FontWeight="Medium" />
            </Border>
        </Grid>
    </Border>
</UserControl>