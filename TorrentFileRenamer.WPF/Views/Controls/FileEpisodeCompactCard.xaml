<UserControl x:Class="TorrentFileRenamer.WPF.Views.Controls.FileEpisodeCompactCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:models="clr-namespace:TorrentFileRenamer.WPF.Models"
      mc:Ignorable="d" 
    d:DataContext="{d:DesignInstance Type=models:FileEpisodeModel}"
   d:DesignHeight="90" d:DesignWidth="1200">
    
    <Border Style="{StaticResource FileCard}"
      Margin="0,0,0,8"
            MinHeight="80">
        <Border.Triggers>
            <EventTrigger RoutedEvent="Loaded">
             <BeginStoryboard Storyboard="{StaticResource CardEntranceAnimation}"/>
      </EventTrigger>
  </Border.Triggers>

        <Grid>
            <!-- Status Accent Bar (4px colored border on left) -->
        <Border Style="{StaticResource StatusBorder}"
  Background="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"/>

      <!-- Compact Single Row Layout -->
      <Grid Margin="20,0,0,0">
   <Grid.ColumnDefinitions>
     <ColumnDefinition Width="Auto"/>   <!-- Status Icon -->
      <ColumnDefinition Width="*"/>      <!-- Content (Show/Episode Info) -->
            <ColumnDefinition Width="Auto"/>   <!-- Status Badge -->
     <ColumnDefinition Width="Auto"/>   <!-- File Size -->
      <ColumnDefinition Width="Auto"/>   <!-- Actions -->
    </Grid.ColumnDefinitions>

   <!-- Status Icon -->
  <TextBlock Grid.Column="0"
              Text="{Binding Status, Converter={StaticResource StatusToIconConverter}}"
          FontSize="24"
         FontFamily="Segoe MDL2 Assets"
    VerticalAlignment="Center"
 Margin="16,0,16,0"
  Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"/>

       <!-- Content Section: Show Info + Episode + Filenames -->
    <StackPanel Grid.Column="1" 
          VerticalAlignment="Center"
    Margin="0,12,16,12">
         
        <!-- Show Name and Episode Info -->
           <Grid>
        <Grid.ColumnDefinitions>
    <ColumnDefinition Width="Auto"/>
 <ColumnDefinition Width="Auto"/>
         <ColumnDefinition Width="*"/>
     </Grid.ColumnDefinitions>

             <TextBlock Grid.Column="0"
  Style="{StaticResource CardTitle}"
Text="{Binding ShowName}"
                    FontSize="14"
     FontWeight="SemiBold"
     VerticalAlignment="Center"
               TextTrimming="CharacterEllipsis"
     MaxWidth="300"
     ToolTip="{Binding ShowName}"/>

             <TextBlock Grid.Column="1"
                 Style="{StaticResource CardSubtitle}"
  FontSize="12"
              VerticalAlignment="Center"
      Margin="12,0,0,0">
 <Run Text="S"/>
     <Run Text="{Binding SeasonNumber, StringFormat='{}{0:D2}', Mode=OneWay}"/>
              <Run Text="E"/>
     <Run Text="{Binding EpisodeNumbers, Mode=OneWay}"/>
            </TextBlock>

    <!-- Multi-episode indicator -->
      <TextBlock Grid.Column="2"
  FontSize="11"
     Foreground="#FF6F00"
  VerticalAlignment="Center"
  Margin="12,0,0,0"
    Visibility="{Binding IsMultiEpisode, Converter={StaticResource BoolToVisibilityConverter}}">
    <Run Text="&#xE8FD;" FontFamily="Segoe MDL2 Assets"/>
       <Run Text=" Multi-Episode"/>
   </TextBlock>
   </Grid>

     <!-- Filename Info (Original ? New) -->
     <TextBlock Style="{StaticResource CardMetadata}"
     FontSize="11"
       Margin="0,4,0,0"
   TextTrimming="CharacterEllipsis">
    <Run Text="&#xE8A5;" FontFamily="Segoe MDL2 Assets" />
      <Run Text=" "/>
<Run Text="{Binding CoreEpisode.FileName, Mode=OneWay}" Foreground="#757575"/>
    <Run Text=" ? " Foreground="#2196F3"/>
        <Run Text="{Binding NewFileName, Mode=OneWay}" FontWeight="Medium" Foreground="#2E7D32"/>
    </TextBlock>

    <!-- Error message (if any) -->
  <TextBlock Style="{StaticResource CardMetadata}"
      FontSize="11"
 Foreground="#D32F2F"
  Margin="0,2,0,0"
       TextTrimming="CharacterEllipsis"
   Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}">
<Run Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets"/>
<Run Text=" "/>
<Run Text="{Binding ErrorMessage, Mode=OneWay}"/>
    </TextBlock>
    </StackPanel>

          <!-- Status Badge -->
    <Border Grid.Column="2"
     Style="{StaticResource StatusBadge}"
       VerticalAlignment="Center"
       Margin="8,0"
     Background="{Binding Status, Converter={StaticResource StatusToBrushConverter}}">
        <TextBlock Style="{StaticResource StatusBadgeText}"
    Text="{Binding StatusText}"/>
 </Border>

        <!-- File Size and Extension -->
        <StackPanel Grid.Column="3" 
        Orientation="Horizontal"
         VerticalAlignment="Center"
                    Margin="8,0,16,0">
        <TextBlock Style="{StaticResource CardMetadata}"
        FontSize="12"
            Text="{Binding CoreEpisode.FileSize, Converter={StaticResource FileSizeConverter}}"
    Margin="0,0,8,0"/>
        <TextBlock Style="{StaticResource CardMetadata}"
           FontSize="12"
        FontWeight="Medium"
      Text="{Binding Extension}"/>
   </StackPanel>

         <!-- Quick Action Buttons -->
<StackPanel Grid.Column="4" 
  Orientation="Horizontal"
     VerticalAlignment="Center"
    Margin="0,0,16,0">
   
  <Button Padding="8,4"
    Style="{StaticResource SecondaryButton}"
      Margin="0,0,4,0"
   FontSize="14"
   ToolTip="Open Folder"
     Command="{Binding DataContext.OpenFolderCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
   CommandParameter="{Binding}">
 <TextBlock Text="&#xE8B7;" FontFamily="Segoe MDL2 Assets"/>
 </Button>

  <Button Padding="8,4"
 Style="{StaticResource SecondaryButton}"
  Margin="0,0,4,0"
 FontSize="14"
 ToolTip="View Details"
  Command="{Binding DataContext.ViewDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
 CommandParameter="{Binding}">
      <TextBlock Text="&#xE946;" FontFamily="Segoe MDL2 Assets"/>
 </Button>

   <Button Padding="8,4"
 Style="{StaticResource PrimaryButton}"
 Margin="0,0,4,0"
  FontSize="14"
   ToolTip="Retry"
Command="{Binding DataContext.RetryCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
   CommandParameter="{Binding}"
   Visibility="{Binding Status, Converter={StaticResource StatusToRetryVisibilityConverter}}">
     <TextBlock Text="&#xE72C;" FontFamily="Segoe MDL2 Assets"/>
   </Button>

  <Button Padding="8,4"
      Style="{StaticResource SecondaryButton}"
   FontSize="14"
   ToolTip="Remove"
     Command="{Binding DataContext.RemoveSelectedCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
   CommandParameter="{Binding}">
       <TextBlock Text="&#xE74D;" FontFamily="Segoe MDL2 Assets"/>
        </Button>
   </StackPanel>
 </Grid>
  </Grid>
 </Border>
</UserControl>
